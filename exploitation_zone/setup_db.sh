#!/bin/bash

# Check if PostgreSQL is installed
if ! command -v psql &> /dev/null; then
    echo "PostgreSQL is not installed. Please install it first."
    exit 1
fi

# Get current username
DB_USER=$(whoami)

# Create .env file if it doesn't exist
if [ ! -f .env ]; then
    echo "Creating .env file..."
    cat > .env << EOL
DB_HOST=localhost
DB_NAME=scholamigo
DB_USER=${DB_USER}
DB_PASSWORD=
EOL
    echo ".env file created!"
fi

# Create database
echo "Creating database..."
psql postgres -c "DROP DATABASE IF EXISTS scholamigo;"
psql postgres -c "CREATE DATABASE scholamigo;"

# Run SQL script
echo "Creating tables and inserting data..."
psql scholamigo -f scripts/Exploitation_erasmus

echo "Database setup complete!" 